A fork of my own work, will update later